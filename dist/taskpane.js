(()=>{var e,t,n,r={195:()=>{},1671:()=>{},5352:()=>{},5365:()=>{},6575:(e,t,n)=>{"use strict";var r=n(4848),s=n(6540),a=n(5338),o=n(20);o.GlobalWorkerOptions.workerSrc=Office.context.document.url.replace(/[^/]+$/,"")+"pdf.worker.min.js";const i=({buffer:e,onSelect:t,isSelectionMode:n,currentMode:a})=>{const i=(0,s.useRef)(null),[c,l]=(0,s.useState)(null),[d,u]=(0,s.useState)(1),[p,f]=(0,s.useState)(0),[g,x]=(0,s.useState)(!1),[h,y]=(0,s.useState)(null),[m,w]=(0,s.useState)(!1),[b,v]=(0,s.useState)(null),[M,j]=(0,s.useState)(null);return(0,s.useEffect)((()=>{if(!e)return l(null),f(0),void u(1);x(!0),y(null),(0,o.getDocument)({data:e}).promise.then((e=>{l(e),f(e.numPages),u(1),x(!1)})).catch((e=>{console.error("Error loading PDF:",e),y("Failed to load PDF document"),x(!1)}))}),[e]),(0,s.useEffect)((()=>{c&&i.current&&(async()=>{x(!0);try{const e=await c.getPage(d),t=e.getViewport({scale:1.25}),n=i.current;n.width=t.width,n.height=t.height;const r=n.getContext("2d");await e.render({canvasContext:r,viewport:t}).promise,x(!1)}catch(e){console.error("Error rendering page:",e),y("Failed to render page"),x(!1)}})()}),[c,d]),e?h?(0,r.jsxs)("div",{style:{padding:"20px",color:"#d13438"},children:["Error: ",h]}):(0,r.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",background:"#fff",borderBottom:"1px solid #ddd"},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,r.jsx)("button",{onClick:()=>{d>1&&u(d-1)},disabled:d<=1,style:{padding:"4px 8px",border:"1px solid #ccc",background:"#fff",borderRadius:"3px",cursor:d<=1?"not-allowed":"pointer",opacity:d<=1?.5:1},children:"◀ Prev"}),(0,r.jsxs)("span",{style:{fontSize:"12px",color:"#666",margin:"0 8px"},children:["Page ",d," of ",p]}),(0,r.jsx)("button",{onClick:()=>{d<p&&u(d+1)},disabled:d>=p,style:{padding:"4px 8px",border:"1px solid #ccc",background:"#fff",borderRadius:"3px",cursor:d>=p?"not-allowed":"pointer",opacity:d>=p?.5:1},children:"Next ▶"})]}),a&&(0,r.jsxs)("div",{style:{padding:"4px 8px",background:"#0078d4",color:"white",borderRadius:"3px",fontSize:"11px",fontWeight:500,textTransform:"uppercase"},children:[a," Mode"]})]}),(0,r.jsx)("div",{style:{flex:1,overflow:"auto",background:"#f0f0f0"},children:g?(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"40px",color:"#666",fontSize:"14px"},children:"Loading..."}):(0,r.jsx)("div",{style:{position:"relative",display:"flex",justifyContent:"center",minHeight:"100%",alignItems:"flex-start",padding:"20px"},children:(0,r.jsxs)("div",{style:{position:"relative"},children:[(0,r.jsx)("canvas",{ref:i,style:{border:"1px solid #ccc",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.1)",background:"white",cursor:n?"crosshair":"default"},onMouseDown:e=>{if(!n||!i.current)return;const t=i.current.getBoundingClientRect(),r=e.clientX-t.left,s=e.clientY-t.top;w(!0),v({x:r,y:s}),j(null)},onMouseMove:e=>{if(!m||!b||!i.current)return;const t=i.current.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top,s={x:Math.min(b.x,n),y:Math.min(b.y,r),width:Math.abs(n-b.x),height:Math.abs(r-b.y)};j(s)},onMouseUp:e=>{if(!m||!b||!i.current)return;const n=i.current,r=n.getBoundingClientRect(),s=e.clientX-r.left,a=e.clientY-r.top,o={x:Math.min(b.x,s),y:Math.min(b.y,a),width:Math.abs(s-b.x),height:Math.abs(a-b.y)};if(o.width>5&&o.height>5){const e=n.getContext("2d").getImageData(o.x,o.y,o.width,o.height);t(e,d,o)}w(!1),v(null),j(null)}}),M&&m&&(0,r.jsx)("div",{style:{position:"absolute",left:M.x,top:M.y,width:M.width,height:M.height,border:"2px dashed #0078d4",background:"rgba(0, 120, 212, 0.1)",pointerEvents:"none",zIndex:10}})]})})}),(0,r.jsxs)("div",{style:{padding:"4px 12px",background:"#f8f9fa",borderTop:"1px solid #ddd",fontSize:"11px",color:"#666"},children:[n?`Ready to select area for ${a} snip`:"Ready",c&&` • Document loaded: ${p} pages`]})]}):(0,r.jsxs)("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:[(0,r.jsx)("p",{children:"No document loaded"}),(0,r.jsx)("small",{children:'Click "Import Docs" to load a PDF file'})]})};var c=n(4995);let l=null;async function d(){return l||(l=await(0,c.createWorker)({logger:e=>console.log("OCR:",e)}),await l.loadLanguage("eng"),await l.initialize("eng"),await l.setParameters({tessedit_char_whitelist:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz .,;:!?@#$%^&*()_+-=[]{}|\\;':\",./<>?`~",tessedit_pageseg_mode:"6"}),l)}async function u(e){const t=await d(),{data:n}=await t.recognize(e);return n.text.trim()}async function p(e){return((await u(e)).match(/-?\d+(?:[.,]\d+)?/g)||[]).map((e=>{const t=e.replace(/,/g,"");return parseFloat(t)})).filter((e=>!isNaN(e)))}class f{static async initialize(){await d()}static async terminate(){l&&(await l.terminate(),l=null)}static async recognizeText(e){const t=await d(),{data:n}=await t.recognize(e);return{text:n.text.trim(),confidence:n.confidence}}static async recognizeNumbers(e){return p(e)}}class g{static calculateSum(e){return e.reduce(((e,t)=>e+t),0)}static async extractAndSum(e){const t=await p(e);return{sum:this.calculateSum(t),numbers:t,text:await u(e)}}}async function x(e){await Excel.run((async t=>{const n=t.workbook.getSelectedRange();n.values=[[e]],n.format.autofitColumns(),await t.sync()}))}async function h(){await x("✓")}async function y(){await x("✗")}const m=new class{constructor(){this._mode=null}async setMode(e){this._mode=e,await OfficeRuntime.storage.setItem("snip-mode",e),await Office.addin.showAsTaskpane()}async current(){return this._mode?this._mode:OfficeRuntime.storage.getItem("snip-mode")}async clearMode(){this._mode=null,await OfficeRuntime.storage.removeItem("snip-mode")}async isActive(){return null!==await this.current()}};Office.onReady((()=>{Office.context.document.addHandlerAsync(Office.EventType.DocumentSelectionChanged,(async()=>{try{const e=await m.current();"validation"===e&&(await h(),await m.clearMode()),"exception"===e&&(await y(),await m.clearMode())}catch(e){console.warn("Error handling selection change:",e)}}))}));var w=n(8985),b=n(2272),v=n(6366),M=n(84);const j=()=>{const[e,t]=(0,s.useState)({currentDocument:null,documentName:"",currentMode:null,isSelectionMode:!1,selectedCellAddress:null,isProcessing:!1,statusMessage:"Ready"});(0,s.useEffect)((()=>(f.initialize().catch(console.error),()=>{f.terminate().catch(console.error)})),[]),(0,s.useEffect)((()=>{const e=async()=>{try{const e=await m.current(),n=await m.isActive();if(e&&n){t((t=>({...t,currentMode:e,isSelectionMode:"text"===e||"sum"===e||"table"===e,statusMessage:`${e.toUpperCase()} mode active - Select a cell then draw rectangle`})));try{const e=await async function(){return await Excel.run((async e=>{const t=e.workbook.getSelectedRange();return t.load("address"),await e.sync(),t.address}))}();t((t=>({...t,selectedCellAddress:e})))}catch(e){console.warn("Could not get cell address:",e)}}else t((e=>({...e,currentMode:null,isSelectionMode:!1,selectedCellAddress:null,statusMessage:"Ready"})))}catch(e){console.error("Error checking mode:",e)}};e();const n=setInterval(e,1e3);return()=>clearInterval(n)}),[]);const n=(0,s.useCallback)((e=>{const n=e.target.files?.[0];n&&("application/pdf"===n.type||n.type.startsWith("image/")?(n.arrayBuffer().then((e=>{t((t=>({...t,currentDocument:e,documentName:n.name,statusMessage:`Loaded: ${n.name}`})))})).catch((e=>{console.error("Error reading file:",e),t((e=>({...e,statusMessage:"Error loading file"})))})),e.target.value=""):t((e=>({...e,statusMessage:"Please select a PDF file or image"}))))}),[]),a=(0,s.useCallback)((async(n,r,s)=>{if(e.currentMode&&e.selectedCellAddress){t((e=>({...e,isProcessing:!0,statusMessage:"Processing selection..."})));try{let a="",o="";switch(e.currentMode){case"text":const t=await f.recognizeText(n);a=t.text,o=t.text,await x(a);break;case"sum":const r=await g.extractAndSum(n);a=r.sum.toString(),o=r.text,await x(a);break;case"table":const s=await f.recognizeText(n),i=s.text.trim().split(/\r?\n/).map((e=>e.split(/\s{2,}|\t/).filter((e=>e.trim().length>0))));i.length>0?(await async function(e){await Excel.run((async t=>{let n;n=t.workbook.getSelectedRange();const r=n.getResizedRange(e.length-1,e[0].length-1);r.values=e,r.format.autofitColumns(),await t.sync()}))}(i),a=`Table (${i.length}x${i[0]?.length||0})`,o=i.map((e=>e.join("\t"))).join("\n")):(a="No table detected",o=s.text,await x(a));break;case"validation":await h(),a="✓",o="Validation mark";break;case"exception":await y(),a="✗",o="Exception mark";break;default:throw new Error(`Unknown mode: ${e.currentMode}`)}await async function(e){await Excel.run((async t=>{let n=t.workbook.worksheets.getItemOrNullObject("_Snips");await t.sync(),n.isNullObject&&(n=t.workbook.worksheets.add("_Snips"),n.visibility=Excel.SheetVisibility.hidden);const r=n.getRange("A:A").getUsedRange().rowCount+1;n.getRange(`A${r}:E${r}`).values=[[e.cell,e.page,e.rect,e.mode,e.text]],await t.sync()}))}({cell:e.selectedCellAddress,page:r,rect:JSON.stringify(s),mode:e.currentMode,text:o}),await m.clearMode(),t((t=>({...t,currentMode:null,isSelectionMode:!1,selectedCellAddress:null,isProcessing:!1,statusMessage:`${e.currentMode.toUpperCase()} snip completed successfully`})))}catch(e){console.error("Error processing snip:",e),t((t=>({...t,isProcessing:!1,statusMessage:`Error: ${e.message||"Processing failed"}`})))}}else t((e=>({...e,statusMessage:"Please select a cell first"})))}),[e.currentMode,e.selectedCellAddress,e.documentName]),o=(0,s.useCallback)((async()=>{await m.clearMode(),t((e=>({...e,currentMode:null,isSelectionMode:!1,selectedCellAddress:null,statusMessage:"Ready"})))}),[]);return(0,r.jsx)(w.q,{theme:b.o,children:(0,r.jsxs)("div",{style:{height:"100vh",display:"flex",flexDirection:"column"},children:[(0,r.jsxs)("div",{style:{padding:"16px",borderBottom:"1px solid #ddd",background:"#fff"},children:[(0,r.jsx)(v.E,{size:500,weight:"semibold",children:"SnipperClone - Document Analysis"}),(0,r.jsxs)("div",{style:{marginTop:"12px"},children:[(0,r.jsx)("input",{type:"file",accept:".pdf,image/*",onChange:n,style:{display:"none"},id:"file-input"}),(0,r.jsx)(M.$,{as:"label",htmlFor:"file-input",appearance:"primary",size:"small",style:{cursor:"pointer"},children:"Import Document"}),e.documentName&&(0,r.jsx)(v.E,{size:200,style:{marginLeft:"8px",color:"#666"},children:e.documentName})]})]}),e.currentMode&&(0,r.jsxs)("div",{style:{padding:"8px 16px",background:"#e6f3ff",borderBottom:"1px solid #ccc",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)(v.E,{size:300,children:[(0,r.jsxs)("strong",{children:[e.currentMode.toUpperCase()," MODE:"]}),e.selectedCellAddress?` Target cell: ${e.selectedCellAddress}`:" Select a cell first"]}),(0,r.jsx)(M.$,{size:"small",onClick:o,children:"Cancel"})]}),(0,r.jsx)("div",{style:{flex:1,overflow:"hidden"},children:(0,r.jsx)(i,{buffer:e.currentDocument,onSelect:a,isSelectionMode:e.isSelectionMode&&!!e.selectedCellAddress,currentMode:e.currentMode})}),(0,r.jsxs)("div",{style:{padding:"8px 16px",background:"#f8f9fa",borderTop:"1px solid #ddd",fontSize:"12px",color:"#666"},children:["Status: ",e.isProcessing?"Processing...":e.statusMessage]})]})})};Office.onReady((()=>{console.log("Office is ready. Starting React app...");const e=document.getElementById("container");if(!e)throw new Error("Container element not found");(0,a.H)(e).render((0,r.jsx)(j,{}))}))},6959:()=>{},8196:()=>{}},s={};function a(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return r[e].call(n.exports,n,n.exports,a),n.exports}a.m=r,e=[],a.O=(t,n,r,s)=>{if(!n){var o=1/0;for(d=0;d<e.length;d++){for(var[n,r,s]=e[d],i=!0,c=0;c<n.length;c++)(!1&s||o>=s)&&Object.keys(a.O).every((e=>a.O[e](n[c])))?n.splice(c--,1):(i=!1,s<o&&(o=s));if(i){e.splice(d--,1);var l=r();void 0!==l&&(t=l)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,r,s]},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,a.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var s=Object.create(null);a.r(s);var o={};t=t||[null,n({}),n([]),n(n)];for(var i=2&r&&e;"object"==typeof i&&!~t.indexOf(i);i=n(i))Object.getOwnPropertyNames(i).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,a.d(s,o),s},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={926:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var r,s,[o,i,c]=n,l=0;if(o.some((t=>0!==e[t]))){for(r in i)a.o(i,r)&&(a.m[r]=i[r]);if(c)var d=c(a)}for(t&&t(n);l<o.length;l++)s=o[l],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(d)},n=self.webpackChunksnipper_clone=self.webpackChunksnipper_clone||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=a.O(void 0,[352],(()=>a(6575)));o=a.O(o)})();